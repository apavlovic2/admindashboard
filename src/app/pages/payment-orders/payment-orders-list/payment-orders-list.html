<div class="payment-orders-container p-4">
  <p-card header="Payment Orders">
    <div class="filters-actions">
      <div class="filters">
        <span class="p-input-icon-left search-box">
          <i class="pi pi-search"></i>
          <input
            pInputText
            placeholder="Search"
            [ngModel]="searchTerm()"
            (ngModelChange)="searchTerm.set($event); applyFilters()"
          />
        </span>

        <p-autoComplete
          [ngModel]="selectedStatus()"
          [suggestions]="statuses"
          (completeMethod)="filterStatuses($event)"
          placeholder="Filter"
          (onSelect)="selectedStatus.set($event.value); applyFilters()"
          (onClear)="selectedStatus.set(null); applyFilters()"
          [forceSelection]="true"
          [dropdown]="true"
          class="status-filter"
        ></p-autoComplete>
      </div>

      <div class="actions">
        <button
          pButton
          label="New Payment Order"
          icon="pi pi-plus"
          class="new-order-btn p-button-success"
          [routerLink]="['/payment-orders/create']"
        ></button>
      </div>
    </div>

    <p-table
      [value]="filteredOrders()"
      [paginator]="true"
      [rows]="10"
      [rowsPerPageOptions]="[5, 10, 20]"
      [responsiveLayout]="'scroll'"
      sortMode="multiple"
      class="orders-table"
    >
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="reference">Reference <p-sortIcon field="reference"></p-sortIcon></th>
          <th pSortableColumn="title">Title <p-sortIcon field="title"></p-sortIcon></th>
          <th>Description</th>
          <th pSortableColumn="status">Status <p-sortIcon field="status"></p-sortIcon></th>
          <th pSortableColumn="amount">Amount <p-sortIcon field="amount"></p-sortIcon></th>
          <th>Currency</th>
          <th pSortableColumn="createdOn">Created On <p-sortIcon field="createdOn"></p-sortIcon></th>
          <th>Actions</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-order>
        <tr>
          <td>{{ order.reference }}</td>
          <td>{{ order.title }}</td>
          <td>{{ order.description }}</td>
          <td>
            <span class="status-tag" [ngClass]="getStatusClass(order.status)">
              {{ order.status }}
            </span>
          </td>
          <td>{{ order.amount | number: '1.2-2' }}</td>
          <td>{{ order.currency }}</td>
          <td>{{ order.createdOn | date: 'medium' }}</td>
          <td class="text-center">
            <button
              pButton
              label="View"
              icon="pi pi-eye"
              class="view-btn p-button-rounded"
              [routerLink]="['/payment-orders', order.reference]"
              pTooltip="View Details"
              tooltipPosition="top"
              appendTo="body"
            ></button>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="8" class="text-center p-3">No payment orders found.</td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
</div>
